(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports={root:"styles_root__2NddW",sidebar:"styles_sidebar__1X4O7",settings:"styles_settings__1IRNF",content:"styles_content__2ogdv",logo:"styles_logo__2qN_x",header:"styles_header__2Nn0Q",main:"styles_main__2lP6H"}},12:function(e,t,a){e.exports={image:"styles_image__2BslV",processedImage:"styles_processedImage__2n3oq",layersContainer:"styles_layersContainer__tvLeE",layer:"styles_layer__1XaRb",originalLayer:"styles_originalLayer__3MTth",processedLayer:"styles_processedLayer__2e1az",root:"styles_root__3cRUh",noImage:"styles_noImage__1UMKP"}},17:function(e,t,a){e.exports={root:"styles_root__quQKB",icon:"styles_icon__15g5s",title:"styles_title__1dpww"}},20:function(e,t,a){e.exports={root:"styles_root__SrPQh",cell:"styles_cell__2YTQi"}},22:function(e,t,a){e.exports={main:"styles_main__3sJOE",octicon:"styles_octicon__1VqCT"}},29:function(e,t,a){e.exports={root:"styles_root__2yjfU"}},30:function(e,t,a){e.exports={root:"styles_root__14DCM"}},35:function(e,t,a){e.exports=a(56)},53:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),c=a.n(o),s=a(10),i=a(27),l=a(34),h="app/controls/UPDATE_SETTINGS",m={};var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case h:var a=t.controls;return Object(l.a)({},e,a);default:return e}},d=Object(s.c)({settings:u}),p=function(){var e=[i.a],t=s.d.apply(void 0,[s.a.apply(void 0,e)].concat([]));return Object(s.e)(d,{},t)},f=a(1),v=a(2),g=a(5),b=a(3),y=a(4),C=a(9),O=a(11),E=a.n(O),_=a(6),k=a.n(_),j=a(13),w=a.n(j),S=a(32);function I(e,t,a,n){for(var r=e.width,o=0;o<4;++o)e.data[4*(r*a+t)+o]=n[o];return e}function D(e,t,a){for(var n=e.width,r=[],o=0;o<4;++o)r[o]=e.data[4*(n*a+t)+o];return r}function N(e,t){for(var a=0,n=0;n<e.length;++n)a+=(e[n]-t[n])*(e[n]-t[n]);return Math.sqrt(a)}function F(e,t){var a=Number.MAX_SAFE_INTEGER,n=[0,0,0,0];return t.forEach(function(t){var r=N(e,t);r<a&&(a=r,n=t)}),n}function x(e){for(var t=e.reduce(function(e,t){for(var a=0;a<4;++a)e[a]+=t[a];return e},[0,0,0,0]),a=0;a<4;++a)t[a]=Math.floor(t[a]/e.length);return t}var P=new(function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).width=0,a.height=0,a.image=null,a.imageSrc=null,a.imageData=null,a.processedImageData=null,a.filter=null,a.filterOptions={},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"setImage",value:function(e){var t=this;return new Promise(function(a,n){t.imageSrc=e,t.image=new Image,t.image.src=t.imageSrc,t.image.onload=function(){t.height=t.image.height,t.width=t.image.width;var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var a=e.getContext("2d");a.drawImage(t.image,0,0),t.imageData=a.getImageData(0,0,t.width,t.height),t.processImage(),t.dispatchEvent(new Event("updateImage"))}})}},{key:"setFilter",value:function(e,t){this.filter=e,this.filterOptions=t,this.processImage()}},{key:"processImage",value:function(){if(this.image){switch(this.filter){case"Pixelizator":var e=this.filterOptions,t=e.colors,a=e.pixelSize,n=e.accurateColors;this.processedImageData=function(e){var t=e.imageData,a=e.pixelSize,n=void 0===a?5:a,r=e.colors,o=e.accurateColors,c=t.width,s=t.height;r=(r=r||w.a.scale(["#00fa26","#580008"]).mode("lch").colors(16)).map(function(e){var t=w()(e).rgba();return t[3]=Math.floor(255*t[3]),t});var i=document.createElement("canvas");i.width=c,i.height=s;for(var l=i.getContext("2d").getImageData(0,0,c,s),h=0;h<c;h+=n)for(var m=0;m<s;m+=n){var u=void 0;if(o){for(var d=[],p=0;p<n;++p)for(var f=0;f<n;++f){var v=D(t,h+p,m+f);d.push(v)}u=F(x(d),r)}else u=F(D(t,h,m),r);for(var g=0;g<n;++g)for(var b=0;b<n;++b)l=I(l,h+g,m+b,u)}return l}({imageData:this.imageData,colors:t,pixelSize:a,accurateColors:n});break;case"Contour":var r=this.filterOptions,o=r.distance,c=r.invert,s=r.transparent,i=r.step,l=r.fillMode;this.processedImageData=function(e){var t=e.imageData,a=e.distance,n=e.invert,r=e.transparent,o=e.step,c=e.fillMode,s=t.width,i=t.height,l=document.createElement("canvas");l.width=s,l.height=i;var h=[0,0,0,255],m=[255,255,255,255];if(n){var u=[m,h];h=u[0],m=u[1]}for(var d=l.getContext("2d").getImageData(0,0,s,i),p=0;p<s;p+=o)for(var f=null,v=0;v<i;v+=o){var g=D(t,p,v),b=m;f&&N(g,f)>a&&(b=h),r&&(m=[0,0,0,0]);for(var y=0;y<o;++y)for(var C=0;C<o;++C)switch(c){case"square-fill":d=I(d,p+y,v+C,b);break;case"square-empty":d=I(d,p+y,v+C,0===y||y===o-1||0===C||C===o-1?b:m);break;case"rain":d=I(d,p+y,v+C,y===C?b:m);break;case"cross":d=I(d,p+y,v+C,y===C||o-1-y===C?b:m)}f=g}return d}({imageData:this.imageData,distance:o,invert:c,transparent:s,step:i,fillMode:l});break;case"None":this.processedImageData=null;break;default:return}this.dispatchEvent(new Event("imageProcessed"))}}}]),t}(Object(S.a)(EventTarget))),M=a(31),A=a(20),z=a.n(A),U=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.colors;return r.a.createElement("div",{className:z.a.root},e.map(function(e){return r.a.createElement("div",{key:e,className:z.a.cell,style:{backgroundColor:e}})}))}}]),t}(r.a.Component),T=["#000000","#fcfcfc","#f8f8f8","#bcbcbc","#7c7c7c","#a4e4fc","#3cbcfc","#0078f8","#0000fc","#b8b8f8","#6888fc","#0058f8","#0000bc","#d8b8f8","#9878f8","#6844fc","#4428bc","#f8b8f8","#f878f8","#d800cc","#940084","#f8a4c0","#f85898","#e40058","#a80020","#f0d0b0","#f87858","#f83800","#a81000","#fce0a8","#fca044","#e45c10","#881400","#f8d878","#f8b800","#ac7c00","#503000","#d8f878","#b8f818","#00b800","#007800","#b8f8b8","#58d854","#00a800","#006800","#b8f8d8","#58f898","#00a844","#005800","#00fcfc","#00e8d8","#008888","#004058","#f8d8f8","#787878"],L=["#f8ffba","#332431","#573752","#784465","#8f476a","#a64c6c","#d9577c","#e04646","#e6634c","#e89851","#e8cb58","#e2ed82","#fcffde","#76e856","#3ae056","#c9fa75","#b5f26b","#41c47c","#46b38e","#4c90a1","#497791","#466287","#424a70","#303042"],q=["#000000","#5F574F","#C2C3C7","#FFF1E8","#FFEC27","#FFA300","#FFCCAA","#AB5236","#FF77A8","#FF004D","#83769C","#7E2553","#29ADFF","#1D2B53","#008751","#00E436"],B=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleChangeOptions=function(e){var t=a.props.onChangeOptions;switch(e.palletMode){case"colorScale":e.colors=w.a.scale([e.fromColor,e.toColor]).mode(e.colorScaleMode).colors(e.totalColors);break;case"fullColor":switch(e.palletScheme){case"schemeCategory10":case"schemeAccent":case"schemeDark2":case"schemePaired":case"schemePastel1":case"schemePastel2":case"schemeSet1":case"schemeSet2":case"schemeSet3":e.colors=M[e.palletScheme];break;case"blackWhite":e.colors=["#FFF","#000"];break;case"pico8":e.colors=q;break;case"battery24":e.colors=L;break;case"nes":e.colors=T}}t(e)},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"renderColorSettings",value:function(){var e=this.props.options;switch(e.palletMode){case"colorScale":return r.a.createElement(k.a,{data:e,onUpdate:this.handleChangeOptions},r.a.createElement(_.DatColor,{key:"fromColor",path:"fromColor",label:"Color from"}),r.a.createElement(_.DatColor,{key:"toColor",path:"toColor",label:"Color to"}),r.a.createElement(_.DatSelect,{key:"colorScaleMode",path:"colorScaleMode",label:"Color scale mode",options:["hsl","hsv","lab","lch"]}),r.a.createElement(_.DatNumber,{key:"totalColors",path:"totalColors",label:"Total colors",min:2,max:32,step:1}));case"fullColor":return r.a.createElement(k.a,{data:e,onUpdate:this.handleChangeOptions},r.a.createElement(_.DatSelect,{key:"palletScheme",path:"palletScheme",label:"Pallet scheme",options:["blackWhite","pico8","battery24","nes","schemeCategory10","schemeAccent","schemeDark2","schemePaired","schemePastel1","schemePastel2","schemeSet1","schemeSet2","schemeSet3"]}))}}},{key:"render",value:function(){var e=this.props.options;return r.a.createElement("div",null,r.a.createElement(k.a,{data:e,onUpdate:this.handleChangeOptions},r.a.createElement(_.DatNumber,{key:"pixelSize",path:"pixelSize",min:1,max:20,step:1,label:"Pixel size"}),r.a.createElement(_.DatBoolean,{key:"accurateColors",path:"accurateColors",label:"Accurate colors"}),r.a.createElement(_.DatSelect,{key:"palletMode",path:"palletMode",label:"Pallet mode",options:["colorScale","fullColor"]})),this.renderColorSettings(),r.a.createElement(U,{colors:e.colors}))}}]),t}(r.a.Component),R=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleChangeOptions=function(e){(0,a.props.onChangeOptions)(e)},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.options;return r.a.createElement("div",null,r.a.createElement(k.a,{data:e,onUpdate:this.handleChangeOptions},r.a.createElement(_.DatNumber,{key:"distance",path:"distance",min:1,max:150,step:1,label:"Color distance"}),r.a.createElement(_.DatBoolean,{key:"invert",path:"invert",label:"Invert"}),r.a.createElement(_.DatBoolean,{key:"transparent",path:"transparent",label:"Transparent back"}),r.a.createElement(_.DatNumber,{key:"step",path:"step",min:1,max:20,step:1,label:"Step"}),r.a.createElement(_.DatSelect,{key:"fillMode",path:"fillMode",label:"Fill mode",options:["square-fill","square-empty","rain","cross"]})))}}]),t}(r.a.Component),W={Pixelizator:{palletMode:"colorScale",palletScheme:"battery24",fromColor:"#fafa6e",toColor:"#2A4858",colorScaleMode:"lch",totalColors:6,pixelSize:5,accurateColors:!0,colors:[]},Contour:{distance:10,invert:!0,transparent:!1,step:2,fillMode:"square-fill"},None:{}};W.Pixelizator.colors=w.a.scale([W.Pixelizator.fromColor,W.Pixelizator.toColor]).mode(W.Pixelizator.colorScaleMode).colors(W.Pixelizator.totalColors);var Q=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={filter:"None",filterOptions:{}},a.handleChangeFilterOptions=function(e){a.setState({filterOptions:e},function(){var e=a.state,t=e.filter,n=e.filterOptions;P.setFilter(t,n)})},a.handleChangeFilter=function(e){var t=e.filter;a.setState({filter:t,filterOptions:W[t]},function(){var e=a.state,t=e.filter,n=e.filterOptions;P.setFilter(t,n)})},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.handleChangeFilter({filter:"Pixelizator"})}},{key:"renderFilterOptions",value:function(){var e=this.state,t=e.filter,a=e.filterOptions;switch(t){case"Pixelizator":return r.a.createElement(B,{options:a,onChangeOptions:this.handleChangeFilterOptions});case"Contour":return r.a.createElement(R,{options:a,onChangeOptions:this.handleChangeFilterOptions})}return r.a.createElement("div",null)}},{key:"render",value:function(){var e=this.props.className;return r.a.createElement("div",{className:e},r.a.createElement(k.a,{data:this.state,onUpdate:this.handleChangeFilter},r.a.createElement(_.DatSelect,{key:"filter",path:"filter",label:"Filter",options:["None","Pixelizator","Contour"]})),this.renderFilterOptions())}}]),t}(r.a.Component);var J=Object(C.b)(function(e,t){return{}},{})(Q),V=a(8),X=a(17),G=a.n(X),K=a(29),H=a.n(K),Y=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.className;return r.a.createElement("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",className:Object(V.a)(e,H.a.root)},r.a.createElement("rect",{width:"32",height:"32",fill:"#137CBD",className:"cell first"}),r.a.createElement("rect",{x:"32",y:"32",width:"32",height:"32",fill:"#DB2C6F",className:"cell second"}))}}]),t}(r.a.Component),Z=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.className;return r.a.createElement("div",{className:Object(V.a)(e,G.a.root)},r.a.createElement(Y,{className:G.a.icon}),r.a.createElement("div",{className:G.a.title},"Pixel Mania"))}}]),t}(r.a.Component),$=a(33),ee=a(30),te=a.n(ee),ae=function(){function e(){Object(f.a)(this,e),this.webcamStream=null,this.canvas=document.createElement("canvas"),this.canvas.width=480,this.canvas.height=360,this.video=document.createElement("video"),this.video.setAttribute("playsInline",""),this.video.setAttribute("autoPlay","")}return Object(v.a)(e,[{key:"start",value:function(){var e=this;return new Promise(function(t,a){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(a){e.video.srcObject=a;var n=a.getVideoTracks()[0].getSettings(),r=n.height,o=n.width;e.canvas.width=o,e.canvas.height=r,e.webcamStream=a,t()}).catch(function(e){a(e)})})}},{key:"stop",value:function(){this.webcamStream&&(this.webcamStream.getTracks()[0].stop(),this.webcamStream=null)}},{key:"getSnapshot",value:function(){return this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.canvas.toDataURL()}}]),e}(),ne=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleClickOpenFile=function(){a.fileUploaderRef.click()},a.handleChangeFile=function(e){var t=e.target.files[0];if(t){var a=new FileReader;a.onload=function(e){var t=e.target.result;P.setImage(t)},a.readAsDataURL(t)}},a.handleChangeCamAsSource=function(e){e.currentTarget.checked?(a.webCam.start(),a.repeatTakeCamImage.start()):(a.webCam.stop(),a.repeatTakeCamImage.stop())},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.repeatTakeCamImage=Object($.a)({action:function(t){var a=e.webCam.getSnapshot();P.setImage(a)},delay:1}),this.webCam=new ae}},{key:"componentWillUnmount",value:function(){this.repeatTakeCamImage.stop(),this.webCam.stop()}},{key:"render",value:function(){var e=this,t=this.props.className;return r.a.createElement("div",{className:Object(V.a)(t,te.a.root)},r.a.createElement("div",null,r.a.createElement("button",{onClick:this.handleClickOpenFile},"Open image file..."),r.a.createElement("input",{type:"file",onChange:this.handleChangeFile,ref:function(t){e.fileUploaderRef=t},style:{display:"none"}})),r.a.createElement("div",null,r.a.createElement("input",{type:"checkbox",id:"camAsSource",onChange:this.handleChangeCamAsSource}),r.a.createElement("label",{htmlFor:"camAsSource"},"WebCam as image source")))}}]),t}(r.a.Component);Object(C.b)(function(e,t){return{}},{})(ne);var re=a(12),oe=a.n(re),ce=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={imageSrc:null},a.handleUpdateImage=function(){a.setState({imageSrc:P.imageSrc})},a.handleImageProcessed=function(){P.processedImageData?(a.processedImageCanvas.width=P.width,a.processedImageCanvas.height=P.height,a.processedImageCanvas.getContext("2d").putImageData(P.processedImageData,0,0)):(a.processedImageCanvas.width=0,a.processedImageCanvas.height=0)},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){P.addEventListener("updateImage",this.handleUpdateImage),P.addEventListener("imageProcessed",this.handleImageProcessed)}},{key:"componentWillUnmount",value:function(){P.removeEventListener("updateImage",this.handleUpdateImage),P.removeEventListener("imageProcessed",this.handleImageProcessed)}},{key:"render",value:function(){var e=this,t=this.props.className,a=this.state.imageSrc;return r.a.createElement("div",{className:Object(V.a)(t,oe.a.root)},r.a.createElement("div",{className:oe.a.layersContainer},r.a.createElement("div",{className:oe.a.originalLayer},a?r.a.createElement("img",{src:a,alt:"",className:oe.a.image}):r.a.createElement("div",{className:oe.a.noImage},"No image selected!")),r.a.createElement("div",{className:oe.a.processedLayer},r.a.createElement("canvas",{className:oe.a.processedImage,ref:function(t){e.processedImageCanvas=t}}))))}}]),t}(r.a.Component);var se=Object(C.b)(function(e,t){return{}},{})(ce),ie=a(22),le=a.n(ie),he=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:le.a.main},r.a.createElement("a",{href:"https://github.com/avin/pixel-mania",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("svg",{className:le.a.octicon,viewBox:"0 0 16 16",version:"1.1","aria-hidden":"true"},r.a.createElement("path",{fillRule:"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"}))))}}]),t}(r.a.Component),me=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.store;return r.a.createElement(C.a,{store:e},r.a.createElement("div",{className:E.a.root},r.a.createElement("div",{className:E.a.sidebar},r.a.createElement(Z,{className:E.a.logo}),r.a.createElement(J,{className:E.a.settings}),r.a.createElement(he,null)),r.a.createElement("div",{className:E.a.content},r.a.createElement(ne,{className:E.a.header}),r.a.createElement(se,{className:E.a.main}))))}}]),t}(r.a.Component);a(53);var ue=p(),de=document.querySelector("#root");c.a.render(r.a.createElement(me,{store:ue}),de),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,2,1]]]);
//# sourceMappingURL=main.047b8d48.chunk.js.map